---
title: Informe NILs
  ![](Logo_UCO.png){width="15%"}
  ![](Logo_FacCiencias.png){width="15%"}
author: "Francisco José García Arrabal. q12gaarf@uco.es"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    number_sections: true
bibliography: ["zotero.bib", "libraries.bib"]
link-citations: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

![](Logo_UCO.png){width="15%"} ![](Logo_FacCiencias.png){width="15%"}

# Introducción

## El trabajo seleccionado

Vamos a trabajar con los datos de @perez2024phenotypic. Este trabajo describe [genes candidatos]{style="color:green"} de la floración en [garbanzo]{style="color:red"} (*Cicer arietinum*) como **MED16**, **BBX24** o **ELF3**, este último también reportado por otros estudios como @ridge_chickpea_2017. Los mecanismos básicos de floración estudiados en la planta modelo *Arabidopsis thaliana* están conservados en las leguminosas (@weller_genetic_2019, @hecht_conservation_2005, @weller_genetic_2015), exceptuando ciertos genes como **CONSTANS** (@wong_isolation_2014).

## Datos

```{r leer-archivo, echo=FALSE, warning=FALSE}
library(readxl)
Data <- read_excel("C:/Users/Fran/Desktop/4º Año Biología/Primer Cuatrimestre/Computación/R Computación/R Markdown/Ejercicio para el 19 de noviembre/12870_2024_5411_MOESM1_ESM.xlsx", skip = 1)
```

Los datos de este proyecto fueron descargados desde [NILsAdrian](https://bmcplantbiol.biomedcentral.com/articles/10.1186/s12870-024-05411-y)

```{r cargar-librerias, echo=FALSE, warning=FALSE, message=FALSE}
library('dplyr')
library('ggplot2')
```

```{r vista-datos, echo=FALSE}
knitr::kable(head(Data, 8), align = 'c', caption = "Tabla 1: Ocho primeras filas")
```

Los datos tienen `r nrow(Data)` filas y `r ncol(Data)` columnas.\
Cada fila se corresponde con un SNP, por tanto, hay `r nrow(Data)` SNPs.

```{r filtrado_datos, echo=FALSE, warning=FALSE, message=FALSE}
Data <- Data %>% filter(CHROM %in% c("NC_021160.1","NC_021161.1", "NC_021162.1", "NC_021163.1", "NC_021164.1", "NC_021165.1","NC_021166.1", "NC_021167.1"))
```

Del total de SNPs detectados, `r nrow(Data)` se corresponden con SNPs situados en cromosomas.

```{r cuenta-cromosomas, echo=FALSE, warning=FALSE, message=FALSE}
Cromosoma <- Data %>% count(CHROM, sort = TRUE)
Cromosoma %>% filter(n>20000)
```

```{r gráfico-barras, echo=FALSE, fig.align='center', width='60%'}
Cromosoma %>% 
  ggplot(aes(x = CHROM, y = n)) +
  geom_bar(stat = "identity") +
  labs(x = "Cromosoma",
       y = "Número de SNPs",
       title = "Figura 1. Número de SNPs por cromosoma")
```

## Hipótesis

Los cromosomas con mayor número de SNPs presentan mayor % de SNPs que no pasan el filtro de calidad.

# Materiales y Métodos

Para llevar a cabo el análisis usamos R [@R-base] con las librerías dplyr [@R-dplyr]\
y ggplot2 [@R-ggplot2]; [@ggplot22016].

# Resultados

```{r select-columns, echo=FALSE, warning=FALSE, message=FALSE}
datos_filtrados <- Data %>% 
  select(CHROM, POS, FILTER)
```

```{r mutate-datos, echo=FALSE, warning=FALSE, message=FALSE}
datos_filtrados <- datos_filtrados %>% 
  mutate(FILTER2 = ifelse(FILTER == "PASS", "PASS", "NOT_PASS"))
```

## Cálculo de porcentaje del cromosoma

```{r summarize, echo=FALSE, warning=FALSE}
resumen <- datos_filtrados %>%
  group_by(CHROM) %>%
  summarise(
    total = n(),
    not_pass = sum(FILTER2 == "NOT_PASS"),
    perc_not_pass = round((not_pass / total) * 100, 1))
```

```{r table-perc, echo=FALSE}
knitr::kable(resumen,
             caption = "Tabla 2. Porcentaje de SNPs no filtrados por cromosoma")
```

## Representación gráfica

```{r scatter, echo = FALSE, warning=FALSE, message=FALSE, fig.align='center', out.width='70%'}
ggplot(resumen, aes(x = total, y = perc_not_pass)) +
  geom_jitter() +
  geom_smooth(method = "lm") +
  labs( x = "Número total de SNPs", y = "% de SNPs no filtrados", title = "Relación entre número total de SNPs y porcentaje de no filtrados" )
```

# Conclusiones
